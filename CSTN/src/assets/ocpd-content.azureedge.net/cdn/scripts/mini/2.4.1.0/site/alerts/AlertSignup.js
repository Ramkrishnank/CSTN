/*! tools 2018-02-09 */
function AlertSignup(){}AlertSignup.SelectedLocationSuggestionSignupAlerts=null,AlertSignup.LocationSelectionFlagSignupAlerts=null,AlertSignup.Origin="landing",AlertSignup.WhatAttributeCategoriesAlertsSelectAll=function(){var a=null;for(a=1==$("#AlertType").prop("selectedIndex")?$("#whatOffenderListViewAlertSignup").find(":input"):$("#whatCrimeListViewAlertSignup").find(":input"),i=0;i<a.length;i++)$(a[i]).is(":visible")&&(a[i].checked=!0)},AlertSignup.WhatAttributeCategoriesAlertsDeselectAll=function(){var a=null;for(a=1==$("#AlertType").prop("selectedIndex")?$("#whatOffenderListViewAlertSignup").find(":input"):$("#whatCrimeListViewAlertSignup").find(":input"),i=0;i<a.length;i++)$(a[i]).is(":visible")&&(a[i].checked=!1)},AlertSignup.WhatCrimeAttributeCategoriesSelected=function(a){var b=$("#whatCrimeListViewAlertSignup").find(":input"),c=alertsModel.WhatSelectedCrimeAttributeCategories;for(i=0;i<c.length;i++){var d=c[i];for(j=0;j<b.length;j++)if(b[j].name==d){b[j].checked="true";break}}0==$("#AlertType").prop("selectedIndex")?$("#whatCrimeListViewAlertSignup").show():$("#whatCrimeListViewAlertSignup").hide()},AlertSignup.WhatOffenderAttributeCategoriesSelected=function(a){var b=$("#whatOffenderListViewAlertSignup").find(":input"),c=alertsModel.WhatSelectedOffenderAttributeCategories;for(i=0;i<c.length;i++){var d=c[i];for(j=0;j<b.length;j++)if(b[j].name==d){b[j].checked="true";break}}1==$("#AlertType").prop("selectedIndex")?$("#whatOffenderListViewAlertSignup").show():$("#whatOffenderListViewAlertSignup").hide()},AlertSignup.WhatPanelClick=function(a,b){if(!b){var c=$("#"+a)[0];1==c.checked?c.checked=!1:c.checked=!0}},AlertSignup.SaveAlert=function(){var a=null,b=$("#AlertType option:selected").text();return EventTracking.AlertPageSave(b),$("#alertLabelForNavTrigger").css("display","none"),"map"==AlertSignup.Origin&&$("#lblnavtrigger").css("display","none"),AlertSignup.ShowLoader(),a=AlertSignup.ValidateAlertInformation(),0==a.valid?void AlertSignup.LoadMessageModal(a.message):void AlertSignup.VerifyAddressSave()},AlertSignup.CancelAlert=function(){alert("Cancelled")},AlertSignup.VerifyAddress=function(){AlertSignup.SpatialFilter=null,AlertSignupMap.ClearGraphics(),$("#spVerifyAddressFound")[0].style.display="none",$("#spVerifyAddressNotFound")[0].style.display="none";var a="";if($("#divAlertsStandardLocationSearch").is(":visible")?a=$("#locationSearchSignupAlerts").val():$("#divAlertsSecondaryLocationSearch").is(":visible")&&(a=$("#txtAlertsLocationSearch").val()),null==AlertSignup.SelectedLocationSuggestionSignupAlerts&&""==a)return AlertSignup.LoadMessageModal("Enter an address to determine if an agency supplies data for your neighborhood."),!1;var b=$("#Buffer").val();return b<=1?void AlertSignup.LoadMessageModal("Select a search distance to determine if an agency supplies data for your neighborhood."):void AlertSignup.GeocodeSearchAddress("verify")},AlertSignup.VerifyAddressSave=function(){AlertSignup.SpatialFilter=null,AlertSignupMap.ClearGraphics(),$("#spVerifyAddressFound")[0].style.display="none",$("#spVerifyAddressNotFound")[0].style.display="none";var a=$("#locationSearchSignupAlerts").val();if(""==a&&(a=$("#txtAlertsLocationSearch").val()),null==AlertSignup.SelectedLocationSuggestionSignupAlerts&&""==a)return AlertSignup.LoadMessageModal("Enter an address to determine if an agency supplies data for your neighborhood."),!1;var b=$("#Buffer").val();return b<=1?void AlertSignup.LoadMessageModal("Select a search distance to determine if an agency supplies data for your neighborhood."):void AlertSignup.GeocodeSearchAddress("save")},AlertSignup.LocationSuggestParametersSignupAlertsLocationSearch=function(){AlertSignup.SelectedLocationSuggestionSignupAlerts=null;var a=$("#locationSearchSecondary").val(),b=[],c=[];return $(".k-loading").css("visibility",""),b.x="-13039898",b.y="3857830",c={text:a,x:b.x,y:b.y},""!=a&&void 0!=a||$(".k-loading").css("visibility","hidden"),c},AlertSignup.LocationSuggestParametersSignupAlerts=function(){AlertSignup.SelectedLocationSuggestionSignupAlerts=null;var a=$("#locationSearchSignupAlerts").val(),b=[],c=[];return $(".k-loading").css("visibility",""),b.x="-13039898",b.y="3857830",c={text:a,x:b.x,y:b.y},""!=a&&void 0!=a||$(".k-loading").css("visibility","hidden"),c},AlertSignup.LocationSuggestSelectedSignupAlerts=function(a){var b=this.dataItem(a.item.index());AlertSignup.SelectedLocationSuggestionSignupAlerts=b,AlertSignup.LocationSelectionFlagSignupAlerts=!0},AlertSignup.LocationSearchTextChangedSignupAlerts=function(){AlertSignup.LocationSelectionFlagSignupAlerts||(AlertSignup.SelectedLocationSuggestionSignupAlerts=null),AlertSignup.LocationSelectionFlagSignupAlerts=!1},AlertSignup.LocationSuggestOpenSignupAlerts=function(){$("div.k-list-container").width("600px")},AlertSignup.GetSelectedAttributesSignupAlerts=function(){var a=null,b=[];for(a=0==$("#AlertType").prop("selectedIndex")?$("#whatCrimeListViewAlertSignup").find(":input"):$("#whatOffenderListViewAlertSignup").find(":input"),i=0;i<a.length;i++)a[i].checked&&b.push(a[i].name);return b},AlertSignup.EndSession=function(a){"staging"==a.origin?window.location="/home":window.location="/login/admin"},AlertSignup.GeocodeSearchAddress=function(a){var b="";if($("#divAlertsStandardLocationSearch").is(":visible")?b=$("#locationSearchSignupAlerts").val():$("#divAlertsSecondaryLocationSearch").is(":visible")&&(b=$("#txtAlertsLocationSearch").val()),b=b.replace(/[^\w\s\.,]/gi,""),null!=AlertSignup.SelectedLocationSuggestionSignupAlerts||""!=b){var c="";(null!=AlertSignup.SelectedLocationSuggestionSignupAlerts&&"0"==AlertSignup.SelectedLocationSuggestionSignupAlerts||""!=b)&&(c="map"==AlertSignup.Origin?ScriptHelper.GetBaseUrl()+"/map/GeocodeLocation":ScriptHelper.GetBaseUrl()+"/alerts/GeocodeLocation"),""!=c&&(null!=AlertSignup.SelectedLocationSuggestionSignupAlerts?$.ajax({url:c,type:"POST",data:{location:AlertSignup.SelectedLocationSuggestionSignupAlerts.Text,id:AlertSignup.SelectedLocationSuggestionSignupAlerts.MagicKey,iscollection:AlertSignup.SelectedLocationSuggestionSignupAlerts.IsCollection,maxlocations:AlertSignupSettings.MaxNumSuggestions},success:function(b){return null!=b.sessionend?void AlertSignup.EndSession(b):void AlertSignup.CheckOrganizations(b,a)},error:function(a,b,c){AlertSignup.LoadErrorModal("Geocode Search Address - "+c,5,851e4)}}):$.ajax({url:c,type:"POST",data:{location:b,id:"",iscollection:!1,maxlocations:AlertSignupSettings.MaxNumSuggestions},success:function(b){return null!=b.sessionend?void AlertSignup.EndSession(b):void AlertSignup.CheckOrganizations(b,a)},error:function(a,b,c){AlertSignup.LoadErrorModal("Geocode Search Address - "+c,5,851e4)}}))}},AlertSignup.CheckOrganizations=function(a,b){var c=$.parseJSON(a);if(0==c.locations.length)return $("#locationSearchSignupAlerts").val(""),void AlertSignup.FlagVerifyAddress(!1);var d=c.locations[0].feature.geometry.x,e=c.locations[0].feature.geometry.y,f=c.locations[0].feature.attributes.Place_addr,g=$("#Buffer").val();""==f&&(f=c.locations[0].feature.attributes.Match_addr),null!=AlertSignup.SelectedLocationSuggestionSignupAlerts&&(address=AlertSignup.SelectedLocationSuggestionSignupAlerts.Text);var h="";h="map"==AlertSignup.Origin?ScriptHelper.GetBaseUrl()+"/Map/CheckOrganizations":ScriptHelper.GetBaseUrl()+"/alerts/CheckOrganizations",$.ajax({url:h,type:"POST",data:{x:d,y:e,address:f,buffer:g},success:function(a){return null!=a.sessionend?void AlertSignup.EndSession(a):void AlertSignup.ProcessCheckOrganizations(a,b,f,g,d,e)},error:function(a,b,c){AlertSignup.LoadErrorModal("Signup Check Organizations - "+c,5,851e4)}})},AlertSignup.ProcessCheckOrganizations=function(a,b,c,d,e,f){var g=!1;if(null==a.Data)return AlertSignup.FlagVerifyAddress(!1),void AlertSignup.LoadMessageModal("Error saving alert");var h=$("#AlertType").val(),g=a.Data.HasOrganization,i=a.Data.HasOffenderData,j=!1;j=2==h?!!i&&g:g;var k=a.Data.SpatialFilter.SourceGeometry;if(AlertSignup.FlagVerifyAddress(j),"save"==b){if(!g)return AlertSignup.LoadMessageModal("Address specified is either invalid or isn't within the agency's boundary"),void AlertSignup.HideLoader();AlertSignup.CompleteSave(k,c,d)}AlertSignupMap.GoToSelectedLocation(c,d,e,f)},AlertSignup.CompleteSave=function(a,b,c){var d="",e=$("#checkboxG2")[0].checked!==!1,f=0==$('[name="radioEmailPref"]')[1].checked?0:1,g=$(".profileInput")[0].value,h=$(".profileInput")[1].value,i=$("#AlertType").val(),j=0==$('[name="radioEmailFormat"]')[1].checked?0:1,k=JSON.stringify(AlertSignup.GetSelectedAttributesSignupAlerts()),l=JSON.stringify(a),m=null;return d="map"==AlertSignup.Origin?ScriptHelper.GetBaseUrl()+"/Map/SaveAlert":ScriptHelper.GetBaseUrl()+"/alerts/SaveAlert",m=AlertSignup.ValidateAlertInformation(),0==m.valid?void AlertSignup.LoadMessageModal(m.message):void $.ajax({url:d,type:"POST",data:{alertType:i,alertName:g,emailAdress:h,emailFormat:f,filter:k,spatialGeom:l,spatialFilter:l,address:b,buffer:c,useSexOffenderURL:e,emailLayout:j},success:function(a){return null!=a.sessionend?void AlertSignup.EndSession(a):(1==a.res?(AlertSignup.LoadSuccessModal(),AlertSignupMap.ClearGraphics()):AlertSignup.LoadErrorModal(a.msg,5,851e4),void AlertSignup.HideLoader())},error:function(a,b,c){AlertSignup.LoadErrorModal("Signup Save - "+c,5,851e4),AlertSignup.HideLoader()}})},AlertSignup.FlagVerifyAddress=function(a){var b=$("#AlertType").find("option:selected").text(),c=b+" Found. We have "+b+" data for this location.",d="We’re sorry, we don’t have "+b+" data for this location. ";$("#spVerifyAddressFound").html(c),$("#spVerifyAddressNotFound").html(d),1==a?($("#spVerifyAddressFound")[0].style.display="block",$("#spVerifyAddressNotFound")[0].style.display="none"):($("#spVerifyAddressFound")[0].style.display="none",$("#spVerifyAddressNotFound")[0].style.display="block")},AlertSignup.ValidateEmail=function(a){var b=/^[_A-Za-z0-9-]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9-]+)*(\.[A-Za-z]{2,6})$/,c=a.search(b),d=!0;return c<0&&(d=!1),d},AlertSignup.ValidateAlertInformation=function(){var a=function(){},b="",c=0==$('[name="radioEmailPref"]')[1].checked?0:1,d=$(".profileInput")[0].value,e=$(".profileInput")[1].value,f=$("#AlertType").val(),g=AlertSignup.GetSelectedAttributesSignupAlerts(),h=$("#Buffer").val();return a.valid=!0,a.message="",0==AlertSignup.ValidateEmail(e)?(a.valid=!1,a.message="Invalid email entered",a):""==d.trim()?(a.valid=!1,a.message="Invalid alert name specified",a):0==g.length?(a.valid=!1,a.message="No record types have been selected",a):h<=1?(a.valid=!1,a.message="Select a search distance to determine if an agency supplies data for your neighborhood.",a):a},AlertSignup.OpenModalOverlay=function(){AlertSignup.HideLoader(),$("#modalAlertBgTransparency").show(),$("#modalAlertDialog").show(),$("#alertLabelForNavTrigger").css("display","none"),"map"==AlertSignup.Origin&&$("#lblnavtrigger").css("display","none")},AlertSignup.CloseModalOverlay=function(){$("#modalAlertBgTransparency").hide(),$("#modalAlertDialog").html(""),$("#modalAlertDialog").hide(),$("#alertLabelForNavTrigger").css("display",""),"map"==AlertSignup.Origin&&$("#lblnavtrigger").css("display","")},AlertSignup.ShowLoader=function(){$("#modalAlertBgTransparency").show(),$("#alertLoader").show()},AlertSignup.HideLoader=function(){$("#modalAlertBgTransparency").hide(),$("#alertLoader").hide()},AlertSignup.AlertsSignupCreateAnother=function(){var a=$("#hfDefaultAlertDistance").val();$("#spVerifyAddressFound")[0].style.display="none",$("#spVerifyAddressNotFound")[0].style.display="none",$(".profileInput").val(""),$(".profileInput")[1].value="",$("#AlertType").val("");for(var b=0;b<$("#Buffer")[0].options.length;b++)if($("#Buffer")[0].options[b].value==a){$("#Buffer")[0].selectedIndex=b;break}$("#locationSearchSignupAlerts").val(""),$("#whatCrimeListViewAlertSignup").show(),$("#whatOffenderListViewAlertSignup").hide(),$("#txtAlertName").attr("placeholder","ex. Crime Near My House"),AlertSignup.WhatAttributeCategoriesAlertsSelectAll()},AlertSignup.UpdateModalMessage=function(a,b){var c="";return c=a.replace('<p class="signup"></p>','<p class="signup" style="text-align: left">'+b+"</p>")},AlertSignup.LoadMessageModal=function(a){var b="";b="map"==AlertSignup.Origin?ScriptHelper.GetBaseUrl()+"/Map/LoadSignupMessageModal":ScriptHelper.GetBaseUrl()+"/alerts/LoadMessageModal",$.ajax({url:b,type:"GET",success:function(b){return null!=b.sessionend?void AlertSignup.EndSession(b):($("#modalAlertDialog").html(AlertSignup.UpdateModalMessage(b,a)),void AlertSignup.OpenModalOverlay())},error:function(a,b,c){alert(c)}})},AlertSignup.LoadSuccessModal=function(){var a="";a="map"==AlertSignup.Origin?ScriptHelper.GetBaseUrl()+"/Map/LoadSignupSuccessModal":ScriptHelper.GetBaseUrl()+"/alerts/LoadSuccessModal",$.ajax({url:a,type:"GET",success:function(a){return null!=a.sessionend?void AlertSignup.EndSession(a):($("#modalAlertDialog").html(a),"map"==AlertSignup.Origin?($("#signUpBackToMap").show(),$("#signUpDismiss").hide()):($("#signUpBackToMap").hide(),$("#signUpDismiss").show()),void AlertSignup.OpenModalOverlay())},error:function(a,b,c){alert(c)}})},AlertSignup.LoadErrorModal=function(a,b,c){var d="";d="map"==AlertSignup.Origin?ScriptHelper.GetBaseUrl()+"/Map/LoadSignupErrorModal":ScriptHelper.GetBaseUrl()+"/alerts/LoadErrorModal",$.ajax({url:d,type:"GET",data:{message:a,errorLevel:b,errorCode:c},success:function(b){return null!=b.sessionend?void AlertSignup.EndSession(b):($("#modalAlertDialog").html(b),$("#alertErrorMessage").html(a),void AlertSignup.OpenModalOverlay())},error:function(a,b,c){alert(c)}})},AlertSignup.AlertTypeChange=function(a){var b="";0==a.selectedIndex?b="Crime":1==a.selectedIndex&&(b="Offender"),"Crime"==b?($("#whatCrimeListViewAlertSignup").show(),$("#whatOffenderListViewAlertSignup").hide(),$("#txtAlertName").attr("placeholder","ex. Crime Near My House")):($("#whatCrimeListViewAlertSignup").hide(),$("#whatOffenderListViewAlertSignup").show(),$("#txtAlertName").attr("placeholder","ex. Sex Offender Near My house")),AlertSignup.WhatAttributeCategoriesAlertsSelectAll()},AlertSignup.OpenLocationSearch=function(){var a=ScriptHelper.GetBaseUrl()+"/Alerts/OpenLocationSearch";$.ajax({url:a,type:"POST",success:function(a){if(null!=a){if(null!=a.sessionend)return void AlertSignup.EndSession(a);$("#divLocationSearch").html(a),$("#sb-site").hide(),$("#alertLabelForNavTrigger").hide(),$("#alertNavigation").hide(),$("#divLocationSearch .k-autocomplete").css("width","100%"),$("#divLocationSearch").show()}},error:function(a,b,c){}})},AlertSignup.CloseLocationSearch=function(){$("#divLocationSearch").html(""),$("#divLocationSearch").hide(),$("#sb-site").show(),$("#alertLabelForNavTrigger").show(),$("#alertNavigation").show()},AlertSignup.ClearLocationSearch=function(){$("#locationSearch").val("")},AlertSignup.GeocodeSearchAddressFromLocationSearch=function(){var a="";if(a=null!=AlertSignup.SelectedLocationSuggestionSignupAlerts?AlertSignup.SelectedLocationSuggestionSignupAlerts.Text:$("#locationSearchSecondary").val(),a=a.replace(/[^\w\s\.,]/gi,""),null!=AlertSignup.SelectedLocationSuggestionSignupAlerts||""!=a){var b="";null==AlertSignup.SelectedLocationSuggestionSignupAlerts&&""==a||(b=ScriptHelper.GetBaseUrl()+"/alerts/GeocodeLocation"),""!=b&&(null!=AlertSignup.SelectedLocationSuggestionSignupAlerts?$.ajax({url:b,type:"POST",data:{location:AlertSignup.SelectedLocationSuggestionSignupAlerts.Text,id:AlertSignup.SelectedLocationSuggestionSignupAlerts.MagicKey,iscollection:AlertSignup.SelectedLocationSuggestionSignupAlerts.IsCollection,maxlocations:AlertSignupSettings.MaxNumSuggestions},success:function(a){if(null!=a.sessionend)return void AlertSignup.EndSession(a);$("#divLocationSearch").html(""),$("#divLocationSearch").hide(),$("#sb-site").show(),$("#alertLabelForNavTrigger").show(),$("#alertNavigation").show();var b=$.parseJSON(a),c=b.locations[0].feature.attributes.Match_addr;$("#txtAlertsLocationSearch").val(c),$("#divAlertsSecondaryLocationSearch .clearSearch").hide()},error:function(a,b,c){}}):$.ajax({url:b,type:"POST",data:{location:a,id:"",iscollection:!1,maxlocations:AlertSignupSettings.MaxNumSuggestions},success:function(a){if(null!=a.sessionend)return void AlertSignup.EndSession(a);$("#divLocationSearch").html(""),$("#divLocationSearch").hide(),$("#sb-site").show(),$("#alertLabelForNavTrigger").show(),$("#alertNavigation").show();var b=$.parseJSON(a),c=b.locations[0].feature.attributes.Match_addr;$("#txtAlertsLocationSearch").val(c)},error:function(a,b,c){}}))}},AlertSignup.MobileMapClearAddressSearch=function(a){a.val(""),AlertSignup.SelectedLocationSuggestionSignupAlerts=null,$("#divAlertsSecondaryLocationSearch .clearSearch").hide()},AlertSignup.CanvasMenuClick=function(){"0px"==$("#sb-site").css("right")?$("#alertNavigation").show():setTimeout(function(){$("#alertNavigation").hide()},500)},AlertSignup.EmailFormatChange=function(a){"radioEPHtml"==a.id?$("#spEmailFormat").show():$("#spEmailFormat").hide()};